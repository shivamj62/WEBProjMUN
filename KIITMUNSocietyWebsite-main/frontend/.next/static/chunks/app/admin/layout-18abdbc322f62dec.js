(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{2898:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(2265),o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),s=(e,t)=>{let r=(0,a.forwardRef)(({color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:i="",children:u,...d},m)=>(0,a.createElement)("svg",{ref:m,...o,width:s,height:s,stroke:r,strokeWidth:c?24*Number(l)/Number(s):l,className:["lucide",`lucide-${n(e)}`,i].join(" "),...d},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r}},6637:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},3167:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]])},5883:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},5750:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(2898).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},8995:function(e,t,r){Promise.resolve().then(r.bind(r,6773))},6773:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(7437),o=r(4033),n=r(4512),s=r(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s.Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var c=r(5750),i=r(6637),u=r(3167);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,s.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var m=r(5883),h=r(3452),p=e=>{var t;let{children:r}=e,s=(0,o.useRouter)(),p=(0,o.usePathname)(),{user:f,logout:g}=(0,h.useAuth)(),D=[{name:"Dashboard",href:"/admin",icon:l,current:"/admin"===p},{name:"Members Management",href:"/admin/members",icon:c.Z,current:"/admin/members"===p},{name:"Blogs Management",href:"/admin/blogs",icon:i.Z,current:"/admin/blogs"===p},{name:"Resources Management",href:"/admin/resources",icon:u.Z,current:"/admin/resources"===p}];return(0,a.jsx)(n.Z,{requiredRole:"admin",children:(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-800",children:[(0,a.jsx)("div",{className:"sticky top-0 z-50 bg-gray-900/95 backdrop-blur-xl border-b border-gray-700/50 shadow-lg",children:(0,a.jsxs)("div",{className:"px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"h-10 w-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:(0,a.jsx)(d,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-white",children:"KIIT MUN Society"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Admin Dashboard"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-800/50 rounded-xl",children:[(0,a.jsx)("div",{className:"h-8 w-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-lg",children:(0,a.jsx)("span",{className:"text-sm font-bold text-white",children:(null==f?void 0:null===(t=f.name)||void 0===t?void 0:t.charAt(0))||"A"})}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-white",children:(null==f?void 0:f.name)||"Admin"}),(0,a.jsx)("p",{className:"text-xs text-gray-400 capitalize",children:(null==f?void 0:f.role)||"admin"})]})]}),(0,a.jsxs)("button",{onClick:()=>{g(),s.push("/")},className:"flex items-center px-4 py-2 text-sm font-medium text-gray-300 rounded-xl hover:bg-red-600/20 hover:text-red-400 transition-all duration-200 group",children:[(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4 text-gray-400 group-hover:text-red-400 transition-colors duration-200"}),"Sign Out"]})]})]}),(0,a.jsx)("nav",{className:"flex items-center space-x-2 overflow-x-auto",children:D.map(e=>{let t=e.icon;return(0,a.jsxs)("button",{onClick:()=>s.push(e.href),className:"\n                      flex items-center px-4 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 group whitespace-nowrap\n                      ".concat(e.current?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg":"text-gray-300 hover:bg-gray-800/50 hover:text-white","\n                    "),children:[(0,a.jsx)(t,{className:"mr-2 h-4 w-4 ".concat(e.current?"text-white":"text-gray-400 group-hover:text-white"," transition-colors duration-200")}),e.name]},e.name)})})]})}),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("main",{className:"p-0",children:r})})]})})}},4512:function(e,t,r){"use strict";var a=r(7437),o=r(2265),n=r(4033),s=r(3452);t.Z=e=>{let{children:t,requiredRole:r,redirectTo:l="/auth/login"}=e,{user:c,isAuthenticated:i,isLoading:u,showPopup:d}=(0,s.useAuth)(),[m,h]=(0,o.useState)(!0),p=(0,n.useRouter)();return((0,o.useEffect)(()=>{if(!u){if(!i){"admin"===r?(d("You need to be logged in as an admin to access this page!"),p.push("/")):p.push(l);return}if(r&&(null==c?void 0:c.role)!==r&&"admin"===r){d("You need to be an admin to access this page!"),p.push("/");return}h(!1)}},[i,u,c,r,p,l,d]),u||m)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-secondary-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-secondary-600",children:"Loading..."})]})}):(0,a.jsx)(a.Fragment,{children:t})}},3452:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return m},useAuth:function(){return l}});var a=r(7437),o=r(2265),n=r(9407);let s=(0,o.createContext)(void 0),l=()=>{let e=(0,o.useContext)(s);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},c=(e,t)=>{let r={token:e,user:{email:t.email,role:t.role,full_name:t.full_name||t.name,id:t.id},credentials:{email:t.email,password:t.password}};localStorage.setItem("munAuth",JSON.stringify(r.credentials)),localStorage.setItem("munAuthToken",e),localStorage.setItem("munAuthUser",JSON.stringify(r.user))},i=()=>{try{let e=localStorage.getItem("munAuthToken"),t=localStorage.getItem("munAuthUser"),r=localStorage.getItem("munAuth");if(!e||!t||!r)return null;return{token:e,user:JSON.parse(t),credentials:JSON.parse(r)}}catch(e){return null}},u=()=>{localStorage.removeItem("munAuth"),localStorage.removeItem("munAuthToken"),localStorage.removeItem("munAuthUser")},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",r=document.createElement("div");r.innerHTML='\n    <div style="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: '.concat("error"===t?"#ef4444":"#10b981",";\n      color: white;\n      padding: 16px 24px;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n      z-index: 9999;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      font-size: 14px;\n      font-weight: 500;\n      max-width: 400px;\n      animation: slideIn 0.3s ease-out;\n    \">\n      ").concat(e,"\n    </div>\n  ");let a=document.createElement("style");a.textContent="\n    @keyframes slideIn {\n      from { transform: translateX(100%); opacity: 0; }\n      to { transform: translateX(0); opacity: 1; }\n    }\n  ",document.head.appendChild(a),document.body.appendChild(r),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),a.parentNode&&a.parentNode.removeChild(a)},4e3)},m=e=>{let{children:t}=e,[r,l]=(0,o.useState)(null),[m,h]=(0,o.useState)(!0),[p,f]=(0,o.useState)(!1),[g,D]=(0,o.useState)(null);(0,o.useEffect)(()=>{(async()=>{let e=i();if(console.log("\uD83C\uDFC1 INIT DEBUG - Auth data from localStorage:",e),e){var t;console.log("\uD83C\uDFC1 INIT DEBUG - User from localStorage:",e.user),console.log("\uD83C\uDFC1 INIT DEBUG - User role from localStorage:",null===(t=e.user)||void 0===t?void 0:t.role);let r=await (0,n.k_)(n.Pn.AUTH.LOGIN,{method:"POST",body:e.credentials});console.log("\uD83C\uDFC1 INIT DEBUG - Verification response:",r),r.success&&r.data&&r.data.success?(console.log("\uD83C\uDFC1 INIT DEBUG - Setting user from localStorage:",e.user),l(e.user),D(e.token),f(!0)):(console.log("\uD83C\uDFC1 INIT DEBUG - Verification failed, clearing auth data"),u())}else console.log("\uD83C\uDFC1 INIT DEBUG - No auth data found in localStorage");h(!1)})()},[]);let x=async(e,t)=>{h(!0);try{var r,a,o,s;let i=await (0,n.k_)(n.Pn.AUTH.LOGIN,{method:"POST",body:{email:e,password:t}});if(console.log("\uD83D\uDD0D AUTH DEBUG - API Response:",i),console.log("\uD83D\uDD0D AUTH DEBUG - Response success:",i.success),console.log("\uD83D\uDD0D AUTH DEBUG - Response data:",i.data),console.log("\uD83D\uDD0D AUTH DEBUG - User data:",null===(r=i.data)||void 0===r?void 0:r.user),console.log("\uD83D\uDD0D AUTH DEBUG - User role:",null===(o=i.data)||void 0===o?void 0:null===(a=o.user)||void 0===a?void 0:a.role),!i.success||!i.data||!i.data.success)return{success:!1,error:(null===(s=i.data)||void 0===s?void 0:s.error)||i.error||"Login failed"};{let e="token_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),r={...i.data.user,password:t};return c(e,r),l(i.data.user),D(e),f(!0),console.log("✅ AUTH DEBUG - User set in context:",i.data.user),console.log("✅ AUTH DEBUG - Auth state updated, isAuthenticated: true"),{success:!0,user:i.data.user,token:e}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Login failed"}}finally{h(!1)}},y=async e=>{try{let t=await (0,n.k_)(n.Pn.AUTH.CHECK_EMAIL,{method:"POST",body:{email:e}});if(console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Raw response:",t),console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Response success:",t.success),console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Response data:",t.data),!t.success||!t.data)return{success:!1,exists:!1,error:t.error||"Check failed"};{let e=t.data;if(console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Email allowed:",e.allowed),console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Account exists:",e.account_exists),e.allowed)return{success:!0,exists:e.account_exists||!1,name:e.name,role:e.role};return{success:!1,exists:!1,error:"Email not pre-approved for registration"}}}catch(e){return console.error("\uD83D\uDD0D EMAIL CHECK DEBUG - Exception:",e),{success:!1,exists:!1,error:e instanceof Error?e.message:"Check failed"}}},E=async e=>{try{var t;let r=await (0,n.k_)(n.Pn.AUTH.CREATE_ACCOUNT,{method:"POST",body:e});if(r.success&&r.data&&r.data.success)return await x(e.email,e.password);return{success:!1,error:(null===(t=r.data)||void 0===t?void 0:t.error)||r.error||"Registration failed"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Registration failed"}}};return(0,a.jsx)(s.Provider,{value:{user:r,isLoading:m,isAuthenticated:p,authToken:g,login:x,logout:()=>{u(),l(null),D(null),f(!1),window.location.href="/"},checkEmailAvailability:y,register:E,checkAdminAccess:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return p?(null==r?void 0:r.role)==="admin"||(e&&d("You need to be an admin to access this page!"),!1):(e&&d("You need to be logged in as an admin to access this page!"),!1)},showPopup:d},children:t})};t.default=s},9407:function(e,t,r){"use strict";r.d(t,{Pn:function(){return u},Sv:function(){return i},WA:function(){return o},cT:function(){return c},k6:function(){return l},k_:function(){return s}});let a="http://127.0.0.1:8000",o=()=>{let e=localStorage.getItem("munAuth");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},n=e=>{let t=e||o();return t?{Authorization:"".concat(t.email,":").concat(t.password)}:{}},s=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r="".concat(a).concat(e);console.log("\uD83C\uDF10 API CALL DEBUG - URL:",r),console.log("\uD83C\uDF10 API CALL DEBUG - API_BASE_URL:",a),console.log("\uD83C\uDF10 API CALL DEBUG - endpoint:",e),console.log("\uD83C\uDF10 API CALL DEBUG - Options:",t);let o={headers:{"Content-Type":"application/json",...t.headers},...t};o.body&&"object"==typeof o.body&&(o.body=JSON.stringify(o.body),console.log("\uD83C\uDF10 API CALL DEBUG - Stringified body:",o.body)),console.log("\uD83C\uDF10 API CALL DEBUG - Making fetch request to:",r);let n=await fetch(r,o);if(console.log("\uD83C\uDF10 API CALL DEBUG - Response status:",n.status),console.log("\uD83C\uDF10 API CALL DEBUG - Response ok:",n.ok),!n.ok){let e=await n.text();return console.log("\uD83C\uDF10 API CALL DEBUG - Error text:",e),{success:!1,error:e||"HTTP ".concat(n.status,": ").concat(n.statusText)}}let s=await n.json();console.log("\uD83C\uDF10 API CALL DEBUG - Raw response data:",s);let l={success:!0,data:s};return console.log("\uD83C\uDF10 API CALL DEBUG - Final result:",l),l}catch(e){return console.log("\uD83C\uDF10 API CALL DEBUG - Catch error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error occurred"}}},l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n();return s(e,{...t,headers:{"Content-Type":"application/json",...r,...t.headers}})},c=async(e,t)=>{try{let r=n(),o="".concat(a).concat(e),s=await fetch(o,{method:"POST",headers:{...r},body:t});if(!s.ok){let e=await s.text();return{success:!1,error:e||"HTTP ".concat(s.status,": ").concat(s.statusText)}}let l=await s.json();return{success:!0,data:l}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Upload failed"}}},i=async(e,t)=>{try{let r=n(),o="".concat(a).concat(e),s=await fetch(o,{headers:r});if(s.ok){let e=await s.blob(),r=window.URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a)}else throw Error("Download failed")}catch(e){throw console.error("Download error:",e),e}},u={AUTH:{CHECK_EMAIL:"/api/auth/check-email",CREATE_ACCOUNT:"/api/auth/create-account",LOGIN:"/api/auth/login"},BLOGS:{LIST:"/api/blogs",GET:e=>"/api/blogs/".concat(e),CREATE:"/api/blogs",UPDATE:e=>"/api/blogs/".concat(e),DELETE:e=>"/api/blogs/".concat(e)},RESOURCES:{LIST:"/api/resources",UPLOAD:"/api/admin/resources/upload",DOWNLOAD:e=>"/api/resources/".concat(e,"/download"),DELETE:e=>"/api/resources/".concat(e)},ADMIN:{DASHBOARD_STATS:"/api/admin/dashboard/stats",MEMBERS:"/api/admin/members",MEMBER_UPDATE:e=>"/api/admin/members/".concat(e),MEMBER_DELETE:e=>"/api/admin/members/".concat(e),ADD_EMAIL:"/api/admin/members/add-email",AUTHORS:"/api/admin/authors",CREATE_AUTHOR:"/api/admin/authors"},HEALTH:"/health"}},622:function(e,t,r){"use strict";var a=r(2265),o=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function i(e,t,r){var a,n={},i=null,u=null;for(a in void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,a)&&!c.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:o,type:e,key:i,ref:u,props:n,_owner:l.current}}t.Fragment=n,t.jsx=i,t.jsxs=i},7437:function(e,t,r){"use strict";e.exports=r(622)},4033:function(e,t,r){e.exports=r(5313)}},function(e){e.O(0,[971,938,744],function(){return e(e.s=8995)}),_N_E=e.O()}]);