(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{5508:function(e,t,o){Promise.resolve().then(o.t.bind(o,3385,23)),Promise.resolve().then(o.bind(o,3452))},3452:function(e,t,o){"use strict";o.r(t),o.d(t,{AuthProvider:function(){return D},useAuth:function(){return c}});var r=o(7437),n=o(2265),a=o(9407);let s=(0,n.createContext)(void 0),c=()=>{let e=(0,n.useContext)(s);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},u=(e,t)=>{let o={token:e,user:{email:t.email,role:t.role,full_name:t.full_name||t.name,id:t.id},credentials:{email:t.email,password:t.password}};localStorage.setItem("munAuth",JSON.stringify(o.credentials)),localStorage.setItem("munAuthToken",e),localStorage.setItem("munAuthUser",JSON.stringify(o.user))},l=()=>{try{let e=localStorage.getItem("munAuthToken"),t=localStorage.getItem("munAuthUser"),o=localStorage.getItem("munAuth");if(!e||!t||!o)return null;return{token:e,user:JSON.parse(t),credentials:JSON.parse(o)}}catch(e){return null}},i=()=>{localStorage.removeItem("munAuth"),localStorage.removeItem("munAuthToken"),localStorage.removeItem("munAuthUser")},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",o=document.createElement("div");o.innerHTML='\n    <div style="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: '.concat("error"===t?"#ef4444":"#10b981",";\n      color: white;\n      padding: 16px 24px;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n      z-index: 9999;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      font-size: 14px;\n      font-weight: 500;\n      max-width: 400px;\n      animation: slideIn 0.3s ease-out;\n    \">\n      ").concat(e,"\n    </div>\n  ");let r=document.createElement("style");r.textContent="\n    @keyframes slideIn {\n      from { transform: translateX(100%); opacity: 0; }\n      to { transform: translateX(0); opacity: 1; }\n    }\n  ",document.head.appendChild(r),document.body.appendChild(o),setTimeout(()=>{o.parentNode&&o.parentNode.removeChild(o),r.parentNode&&r.parentNode.removeChild(r)},4e3)},D=e=>{let{children:t}=e,[o,c]=(0,n.useState)(null),[D,m]=(0,n.useState)(!0),[E,f]=(0,n.useState)(!1),[p,g]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{let e=l();if(console.log("\uD83C\uDFC1 INIT DEBUG - Auth data from localStorage:",e),e){var t;console.log("\uD83C\uDFC1 INIT DEBUG - User from localStorage:",e.user),console.log("\uD83C\uDFC1 INIT DEBUG - User role from localStorage:",null===(t=e.user)||void 0===t?void 0:t.role);let o=await (0,a.k_)(a.Pn.AUTH.LOGIN,{method:"POST",body:e.credentials});console.log("\uD83C\uDFC1 INIT DEBUG - Verification response:",o),o.success&&o.data&&o.data.success?(console.log("\uD83C\uDFC1 INIT DEBUG - Setting user from localStorage:",e.user),c(e.user),g(e.token),f(!0)):(console.log("\uD83C\uDFC1 INIT DEBUG - Verification failed, clearing auth data"),i())}else console.log("\uD83C\uDFC1 INIT DEBUG - No auth data found in localStorage");m(!1)})()},[]);let h=async(e,t)=>{m(!0);try{var o,r,n,s;let l=await (0,a.k_)(a.Pn.AUTH.LOGIN,{method:"POST",body:{email:e,password:t}});if(console.log("\uD83D\uDD0D AUTH DEBUG - API Response:",l),console.log("\uD83D\uDD0D AUTH DEBUG - Response success:",l.success),console.log("\uD83D\uDD0D AUTH DEBUG - Response data:",l.data),console.log("\uD83D\uDD0D AUTH DEBUG - User data:",null===(o=l.data)||void 0===o?void 0:o.user),console.log("\uD83D\uDD0D AUTH DEBUG - User role:",null===(n=l.data)||void 0===n?void 0:null===(r=n.user)||void 0===r?void 0:r.role),!l.success||!l.data||!l.data.success)return{success:!1,error:(null===(s=l.data)||void 0===s?void 0:s.error)||l.error||"Login failed"};{let e="token_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),o={...l.data.user,password:t};return u(e,o),c(l.data.user),g(e),f(!0),console.log("✅ AUTH DEBUG - User set in context:",l.data.user),console.log("✅ AUTH DEBUG - Auth state updated, isAuthenticated: true"),{success:!0,user:l.data.user,token:e}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Login failed"}}finally{m(!1)}},A=async e=>{try{let t=await (0,a.k_)(a.Pn.AUTH.CHECK_EMAIL,{method:"POST",body:{email:e}});if(console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Raw response:",t),console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Response success:",t.success),console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Response data:",t.data),!t.success||!t.data)return{success:!1,exists:!1,error:t.error||"Check failed"};{let e=t.data;if(console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Email allowed:",e.allowed),console.log("\uD83D\uDD0D EMAIL CHECK DEBUG - Account exists:",e.account_exists),e.allowed)return{success:!0,exists:e.account_exists||!1,name:e.name,role:e.role};return{success:!1,exists:!1,error:"Email not pre-approved for registration"}}}catch(e){return console.error("\uD83D\uDD0D EMAIL CHECK DEBUG - Exception:",e),{success:!1,exists:!1,error:e instanceof Error?e.message:"Check failed"}}},C=async e=>{try{var t;let o=await (0,a.k_)(a.Pn.AUTH.CREATE_ACCOUNT,{method:"POST",body:e});if(o.success&&o.data&&o.data.success)return await h(e.email,e.password);return{success:!1,error:(null===(t=o.data)||void 0===t?void 0:t.error)||o.error||"Registration failed"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Registration failed"}}};return(0,r.jsx)(s.Provider,{value:{user:o,isLoading:D,isAuthenticated:E,authToken:p,login:h,logout:()=>{i(),c(null),g(null),f(!1),window.location.href="/"},checkEmailAvailability:A,register:C,checkAdminAccess:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return E?(null==o?void 0:o.role)==="admin"||(e&&d("You need to be an admin to access this page!"),!1):(e&&d("You need to be logged in as an admin to access this page!"),!1)},showPopup:d},children:t})};t.default=s},9407:function(e,t,o){"use strict";o.d(t,{Pn:function(){return i},Sv:function(){return l},WA:function(){return n},cT:function(){return u},k6:function(){return c},k_:function(){return s}});let r="http://127.0.0.1:8000",n=()=>{let e=localStorage.getItem("munAuth");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}},a=e=>{let t=e||n();return t?{Authorization:"".concat(t.email,":").concat(t.password)}:{}},s=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let o="".concat(r).concat(e);console.log("\uD83C\uDF10 API CALL DEBUG - URL:",o),console.log("\uD83C\uDF10 API CALL DEBUG - API_BASE_URL:",r),console.log("\uD83C\uDF10 API CALL DEBUG - endpoint:",e),console.log("\uD83C\uDF10 API CALL DEBUG - Options:",t);let n={headers:{"Content-Type":"application/json",...t.headers},...t};n.body&&"object"==typeof n.body&&(n.body=JSON.stringify(n.body),console.log("\uD83C\uDF10 API CALL DEBUG - Stringified body:",n.body)),console.log("\uD83C\uDF10 API CALL DEBUG - Making fetch request to:",o);let a=await fetch(o,n);if(console.log("\uD83C\uDF10 API CALL DEBUG - Response status:",a.status),console.log("\uD83C\uDF10 API CALL DEBUG - Response ok:",a.ok),!a.ok){let e=await a.text();return console.log("\uD83C\uDF10 API CALL DEBUG - Error text:",e),{success:!1,error:e||"HTTP ".concat(a.status,": ").concat(a.statusText)}}let s=await a.json();console.log("\uD83C\uDF10 API CALL DEBUG - Raw response data:",s);let c={success:!0,data:s};return console.log("\uD83C\uDF10 API CALL DEBUG - Final result:",c),c}catch(e){return console.log("\uD83C\uDF10 API CALL DEBUG - Catch error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error occurred"}}},c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a();return s(e,{...t,headers:{"Content-Type":"application/json",...o,...t.headers}})},u=async(e,t)=>{try{let o=a(),n="".concat(r).concat(e),s=await fetch(n,{method:"POST",headers:{...o},body:t});if(!s.ok){let e=await s.text();return{success:!1,error:e||"HTTP ".concat(s.status,": ").concat(s.statusText)}}let c=await s.json();return{success:!0,data:c}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Upload failed"}}},l=async(e,t)=>{try{let o=a(),n="".concat(r).concat(e),s=await fetch(n,{headers:o});if(s.ok){let e=await s.blob(),o=window.URL.createObjectURL(e),r=document.createElement("a");r.href=o,r.download=t,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(o),document.body.removeChild(r)}else throw Error("Download failed")}catch(e){throw console.error("Download error:",e),e}},i={AUTH:{CHECK_EMAIL:"/api/auth/check-email",CREATE_ACCOUNT:"/api/auth/create-account",LOGIN:"/api/auth/login"},BLOGS:{LIST:"/api/blogs",GET:e=>"/api/blogs/".concat(e),CREATE:"/api/blogs",UPDATE:e=>"/api/blogs/".concat(e),DELETE:e=>"/api/blogs/".concat(e)},RESOURCES:{LIST:"/api/resources",UPLOAD:"/api/admin/resources/upload",DOWNLOAD:e=>"/api/resources/".concat(e,"/download"),DELETE:e=>"/api/resources/".concat(e)},ADMIN:{DASHBOARD_STATS:"/api/admin/dashboard/stats",MEMBERS:"/api/admin/members",MEMBER_UPDATE:e=>"/api/admin/members/".concat(e),MEMBER_DELETE:e=>"/api/admin/members/".concat(e),ADD_EMAIL:"/api/admin/members/add-email",AUTHORS:"/api/admin/authors",CREATE_AUTHOR:"/api/admin/authors"},HEALTH:"/health"}},3385:function(){},622:function(e,t,o){"use strict";var r=o(2265),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,o){var r,a={},l=null,i=null;for(r in void 0!==o&&(l=""+o),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(i=t.ref),t)s.call(t,r)&&!u.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:n,type:e,key:l,ref:i,props:a,_owner:c.current}}t.Fragment=a,t.jsx=l,t.jsxs=l},7437:function(e,t,o){"use strict";e.exports=o(622)}},function(e){e.O(0,[971,938,744],function(){return e(e.s=5508)}),_N_E=e.O()}]);